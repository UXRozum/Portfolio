# ?????? ?????? ??????????. ???? ?? ???, ?? ????????? ???????? install.packages(c('readxl', 'xlsx', 'igraph'))

library(readxl)
library(xlsx)
library(igraph)

#????????? ?????? (???????? ? ?????? ? ????? ????????? - "??????" ? "???????? ????????")
Data <- read_excel( choose.files())

#?????? ??????? ??????????
Data2 <- crossprod(table(Data[1:2]))
diag(Data2) <- 0

#????? ?? ????????? ???????? ?????????? ? ??????, ??? ?????????????. 
date <- str_replace_all(string=date(), pattern=" ", repl="")
date <- str_replace_all(string=date, pattern=":", repl="")
tttttest <- paste(choose.dir(),"\\",'cardsort',date,".xlsx", sep='')
write.xlsx(Data2,file=tttttest, row.names = TRUE)
  
#?????? ????, ??? ????? ????????? ????? ??????? ? ????? ??????????.
Graph1 <- graph_from_adjacency_matrix(Data2, mode='undirected')
plot.igraph(Graph1,vertex.label.color= "black", vertex.color= "gray", 
            vertex.size= 15, vertex.frame.color='gray')


